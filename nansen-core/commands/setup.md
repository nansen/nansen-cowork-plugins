---
description: Set up the Nansen intelligence ecosystem for a new team member
allowed-tools: Read, Write, Edit, Bash(ls:*), Bash(mkdir:*), Bash(cp:*), Bash(find:*), Bash(test:*), Bash(cat:*), Bash(echo:*), Bash(date:*), Bash(python3:*), Bash(npm:*), Bash(node:*)
---

Walk the user through setting up Nansen's intelligence ecosystem on their machine. Follow these steps in order, checking status at each stage before moving on. Be conversational and helpful -- the user may not be technical. Use clear language and explain what each step does and why.

## Step 1 -- Check folder access

Check if a workspace folder is currently connected by listing the contents of the mounted directory. Look for a `nansen` directory or the nansen-core plugin folder.

If no folder is connected:
- Tell the user: "First, I need access to your Nansen workspace folder. Click the folder icon in the sidebar and select the folder where you keep your Nansen work (or where you'd like to set one up)."
- Wait for them to confirm, then re-check.

If a folder IS connected, check what already exists. Look for:
- `nansen/sources/` directory
- `nansen/intelligence/` directory
- `nansen/outputs/` directory
- `.nansen-config.json` file

Report what you find. If everything exists and the config file is present, ask if they want to re-run setup or if they're all set.

## Step 2 -- Create folder structure

Create the three core directories if they don't already exist:

```
nansen/
├── sources/          # Raw input files (PDFs, transcripts, notes)
├── intelligence/     # Extracted knowledge (synced to Google Drive)
└── outputs/          # Generated deliverables (reports, docs, analysis)
```

For each directory, create it and add a brief README.md inside explaining its purpose:

**sources/README.md**: "This folder holds your raw source material - meeting transcripts from Fathom, PDFs, research documents, email exports, and notes. Drop files here and use the Market Research skill to extract intelligence from them."

**intelligence/README.md**: "This is the team knowledge base. Intelligence files here are synced to Google Drive so everyone on the team can access them. Don't edit these manually - they're generated by extraction skills and follow a specific format (YAML frontmatter + markdown)."

**outputs/README.md**: "This folder holds deliverables generated from intelligence - client reports, analysis documents, presentations, and other outputs. These stay local to your machine."

After creating, confirm: "Your folder structure is ready. Here's what I set up: [list the three folders with a brief description of each]."

## Step 3 -- Google Drive (read access)

The Google Drive MCP connector is available for reading existing documents from Drive -- no setup needed. Skills can search and pull documents from the team's Shared Drive automatically.

Confirm the connector is working by running a quick test search against Google Drive. If it returns results, note it as connected in the config.

**Note on intelligence sharing (future):** For the POC, intelligence files stay in the local intelligence/ folder. Syncing intelligence files to the team's Shared Drive (Nansen > nansen-cowork > intelligence) is a priority item for Phase 2. The approach for sharing extracted knowledge across the team is still being worked out. For now, focus on proving the extraction pipeline works.

## Step 4 -- Fathom connection

Fathom (https://fathom.video) records and transcribes meetings. The nansen-core plugin includes a remote Fathom MCP server hosted on Cloudflare Workers that provides `list_meetings`, `get_transcript`, and `get_meeting_details` tools. The server is already configured in the plugin's `.mcp.json` -- the only thing needed from the user is their Fathom API key.

**No local installation is required.** No Node.js, no npm, no terminal commands. The server runs in the cloud and the plugin connects to it automatically.

### Collect the API key

**Always explicitly ask the user for their Fathom API key.** Don't skip this silently -- prompt them directly and give them the option to enter it now or skip.

Say something like: "Next I need to connect Fathom so we can pull your meeting transcripts automatically. Do you have your Fathom API key handy? If not, here's how to get one -- it only takes a minute."

Then show them the steps:

1. Log into Fathom at https://fathom.video
2. Go to **Settings** (top right corner)
3. Scroll down to the **My Settings** section and find **API Access**
4. Click **Add**, then **Generate API Key**
5. Give the key a name (e.g., "Nansen Intelligence")
6. Click **Create API Client**
7. Copy the API key that appears

Then ask: "Paste your API key here when you're ready, or type 'skip' if you'd like to set this up later."

Note: Fathom API keys are user-level, which means each person's key only gives access to meetings they recorded or that were shared to their team. Each pilot member will need to generate their own key.

### If they provide a key

Save it as an environment variable so the plugin can use it automatically on future sessions:

```bash
# Add to ~/.zshrc (or ~/.bashrc for bash users)
echo 'export FATHOM_API_KEY="their-key-here"' >> ~/.zshrc
```

Tell the user: "I've saved your Fathom API key. You'll need to start a new Cowork session for it to take effect, but from then on Fathom will connect automatically every time."

Store in config: `fathom_connected: true, api_key_set: true`

### If they skip

That's fine -- let them know they can always drop transcript files into sources/ manually, and they can re-run /setup later to add the key.

Store in config: `fathom_connected: false, api_key_set: false`

## Step 5 -- Slack verification

Check if the Slack MCP connector is available by looking at the current conversation context. The Slack connector should already be set up in Cowork.

If Slack is available:
- Run a quick test search to confirm it's working
- Note: "Slack is connected. Skills can search your Slack workspace for relevant messages and threads."

If Slack doesn't appear to be connected:
- Explain: "The Slack connector lets skills search your workspace for relevant context. You can set it up in Cowork's connector settings."
- This is optional for POC -- note in config and move on

## Step 6 -- Generate config file

Create `.nansen-config.json` in the workspace root with the collected information:

```json
{
  "version": "1.0.0",
  "setup_date": "[ISO-8601 timestamp]",
  "setup_by": "[user name from conversation]",
  "workspace_paths": {
    "sources": "[absolute path to sources/]",
    "intelligence": "[absolute path to intelligence/]",
    "outputs": "[absolute path to outputs/]"
  },
  "google_drive": {
    "installed": true/false,
    "mount_path": "[detected path or null]",
    "shared_drive_folder": "[user-specified or null]",
    "sync_configured": true/false
  },
  "fathom": {
    "connected": true/false,
    "api_key_set": true/false
  },
  "slack": {
    "mcp_connected": true/false
  },
  "pilot_group": true
}
```

Write this file and confirm: "Your config is saved. Here's a summary of your setup."

## Step 7 -- Verification diagnostic

Run a quick health check to make sure everything is working:

1. **Folder check**: Verify all three directories exist and are writable
2. **Write test**: Create a small test file in intelligence/ called `_setup-verification.intelligence.md` with proper YAML frontmatter:

```markdown
---
title: Setup Verification Test
date: [today's date]
source_type: document
domains:
  - team-insights
version: 1
updated: [ISO-8601 now]
updated_by: nansen-core setup
---

# Setup Verification

This file was created by the /setup command to verify the intelligence pipeline is working correctly. You can safely delete this file.

Setup completed on [date] by [user name].
```

3. **Config check**: Read back the config file and confirm it's valid JSON
4. **Fathom check**: If the user provided an API key in Step 4, note PASS (key saved, will connect on next session). If they skipped, note SKIPPED. No server verification needed here -- the remote server is always running.
5. **Drive sync note**: If Drive is configured, remind the user to check that the test file appears in their Shared Drive within a minute or two

Present results as a checklist:
- Folder structure: PASS/FAIL
- Intelligence file creation: PASS/FAIL
- Config file: PASS/FAIL
- Fathom MCP server: PASS/FAIL/SKIPPED
- Google Drive: CONFIGURED/SKIPPED
- Fathom API key: CONNECTED/SKIPPED
- Slack: CONNECTED/SKIPPED

## Wrap up

End with next steps:
- "You're all set! Here's what you can do next:"
- "Run `/onboarding` for a guided tour of how everything works"
- "Drop a PDF or transcript into sources/ and ask me to extract intelligence from it"
- "Ask me to run the Market Research skill on any source file"
