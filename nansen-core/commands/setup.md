---
description: Set up the Nansen intelligence ecosystem for a new team member
allowed-tools: Read, Write, Edit, Bash(ls:*), Bash(mkdir:*), Bash(cp:*), Bash(find:*), Bash(test:*), Bash(cat:*), Bash(echo:*), Bash(date:*), Bash(python3:*), Bash(npm:*), Bash(node:*)
---

Walk the user through setting up Nansen's intelligence ecosystem on their machine. Follow these steps in order, checking status at each stage before moving on. Be conversational and helpful -- the user may not be technical. Use clear language and explain what each step does and why.

## Step 1 -- Check folder access

Check if a workspace folder is currently connected by listing the contents of the mounted directory. Look for a `nansen` directory or the nansen-core plugin folder.

If no folder is connected:
- Tell the user: "First, I need access to your Nansen workspace folder. Click the folder icon in the sidebar and select the folder where you keep your Nansen work (or where you'd like to set one up)."
- Wait for them to confirm, then re-check.

If a folder IS connected, check what already exists. Look for:
- `nansen/sources/` directory
- `nansen/intelligence/` directory
- `nansen/outputs/` directory
- `.nansen-config.json` file

Report what you find. If everything exists and the config file is present, ask if they want to re-run setup or if they're all set.

## Step 2 -- Create folder structure

Create the three core directories if they don't already exist:

```
nansen/
├── sources/          # Raw input files (PDFs, transcripts, notes)
├── intelligence/     # Extracted knowledge (synced to Google Drive)
└── outputs/          # Generated deliverables (reports, docs, analysis)
```

For each directory, create it and add a brief README.md inside explaining its purpose:

**sources/README.md**: "This folder holds your raw source material - meeting transcripts from Fathom, PDFs, research documents, email exports, and notes. Drop files here and use the Market Research skill to extract intelligence from them."

**intelligence/README.md**: "This is the team knowledge base. Intelligence files here are synced to Google Drive so everyone on the team can access them. Don't edit these manually - they're generated by extraction skills and follow a specific format (YAML frontmatter + markdown)."

**outputs/README.md**: "This folder holds deliverables generated from intelligence - client reports, analysis documents, presentations, and other outputs. These stay local to your machine."

After creating, confirm: "Your folder structure is ready. Here's what I set up: [list the three folders with a brief description of each]."

## Step 3 -- Google Drive (read access)

The Google Drive MCP connector is available for reading existing documents from Drive -- no setup needed. Skills can search and pull documents from the team's Shared Drive automatically.

Confirm the connector is working by running a quick test search against Google Drive. If it returns results, note it as connected in the config.

**Note on intelligence sharing (future):** For the POC, intelligence files stay in the local intelligence/ folder. Syncing intelligence files to the team's Shared Drive (Nansen > nansen-cowork > intelligence) is a priority item for Phase 2. The approach for sharing extracted knowledge across the team is still being worked out. For now, focus on proving the extraction pipeline works.

## Step 4 -- Fathom connection (optional for POC)

Fathom (https://fathom.video) records and transcribes meetings. nansen-core includes a bundled Fathom MCP server that provides `list_meetings`, `get_transcript`, and `get_meeting_details` tools.

### 4a -- Install Fathom MCP server dependencies

First, install the npm dependencies for the Fathom MCP server. Locate the `servers/fathom/` directory inside the nansen-core plugin folder and run:

```bash
npm install --prefix [path-to-nansen-core]/servers/fathom/
```

Check whether `node_modules` already exists in that directory first. If it does, skip the install.

If the install fails (e.g. npm or Node.js not found), tell the user:
- "The Fathom connector needs Node.js installed. You can get it from https://nodejs.org/"
- Note this in the config and move on -- they can install later

### 4b -- API key setup

Ask: "Do you use Fathom for meeting recordings? If so, I can help connect it so we can pull transcripts automatically."

If yes, walk them through creating an API key:
1. Log into Fathom at https://fathom.video
2. Go to **Settings** (top right corner)
3. Scroll down to the **My Settings** section and find **API Access**
4. Click **Add**, then **Generate API Key**
5. Give the key a name (e.g., "Nansen Intelligence")
6. Click **Create API Client**
7. Copy the API key -- they'll need to paste it here

Note: Fathom API keys are user-level, which means each person's key only gives access to meetings they recorded or that were shared to their team. Each pilot member will need to generate their own key.

- Ask them to paste their API key
- Explain that they need to set `FATHOM_API_KEY` as an environment variable (add `export FATHOM_API_KEY="your-key"` to `~/.zshrc` or `~/.bashrc`)
- Store the key reference in the config
- Explain: "Once connected, you can ask me to list your recent Fathom meetings and pull transcripts directly. You can also still drop transcript files into sources/ manually."

If no or they want to skip:
- That's fine -- they can always add files to sources/ manually
- Note this in the config as `fathom_connected: false`

## Step 5 -- Slack verification

Check if the Slack MCP connector is available by looking at the current conversation context. The Slack connector should already be set up in Cowork.

If Slack is available:
- Run a quick test search to confirm it's working
- Note: "Slack is connected. Skills can search your Slack workspace for relevant messages and threads."

If Slack doesn't appear to be connected:
- Explain: "The Slack connector lets skills search your workspace for relevant context. You can set it up in Cowork's connector settings."
- This is optional for POC -- note in config and move on

## Step 6 -- Generate config file

Create `.nansen-config.json` in the workspace root with the collected information:

```json
{
  "version": "1.0.0",
  "setup_date": "[ISO-8601 timestamp]",
  "setup_by": "[user name from conversation]",
  "workspace_paths": {
    "sources": "[absolute path to sources/]",
    "intelligence": "[absolute path to intelligence/]",
    "outputs": "[absolute path to outputs/]"
  },
  "google_drive": {
    "installed": true/false,
    "mount_path": "[detected path or null]",
    "shared_drive_folder": "[user-specified or null]",
    "sync_configured": true/false
  },
  "fathom": {
    "connected": true/false,
    "api_key_set": true/false
  },
  "slack": {
    "mcp_connected": true/false
  },
  "pilot_group": true
}
```

Write this file and confirm: "Your config is saved. Here's a summary of your setup."

## Step 7 -- Verification diagnostic

Run a quick health check to make sure everything is working:

1. **Folder check**: Verify all three directories exist and are writable
2. **Write test**: Create a small test file in intelligence/ called `_setup-verification.intelligence.md` with proper YAML frontmatter:

```markdown
---
title: Setup Verification Test
date: [today's date]
source_type: document
domains:
  - team-insights
version: 1
updated: [ISO-8601 now]
updated_by: nansen-core setup
---

# Setup Verification

This file was created by the /setup command to verify the intelligence pipeline is working correctly. You can safely delete this file.

Setup completed on [date] by [user name].
```

3. **Config check**: Read back the config file and confirm it's valid JSON
4. **Fathom server check**: If Fathom is connected, verify the MCP server starts correctly by running a quick initialization handshake:
   ```bash
   echo '{"jsonrpc":"2.0","id":1,"method":"initialize","params":{"protocolVersion":"2024-11-05","capabilities":{},"clientInfo":{"name":"test","version":"1.0"}}}' | FATHOM_API_KEY="test" timeout 5 node [path-to-servers/fathom/server.mjs]
   ```
   If the response contains `"serverInfo"`, the server is working. If it fails, check that npm install was run and Node.js is available.
5. **Drive sync note**: If Drive is configured, remind the user to check that the test file appears in their Shared Drive within a minute or two

Present results as a checklist:
- Folder structure: PASS/FAIL
- Intelligence file creation: PASS/FAIL
- Config file: PASS/FAIL
- Fathom MCP server: PASS/FAIL/SKIPPED
- Google Drive: CONFIGURED/SKIPPED
- Fathom API key: CONNECTED/SKIPPED
- Slack: CONNECTED/SKIPPED

## Wrap up

End with next steps:
- "You're all set! Here's what you can do next:"
- "Run `/onboarding` for a guided tour of how everything works"
- "Drop a PDF or transcript into sources/ and ask me to extract intelligence from it"
- "Ask me to run the Market Research skill on any source file"
